import{r as m,b as Z,V as L,Q as ee,c as Ke,d as Xe,e as J,E as Ye,S as Te,M as en,u as I,O as nn,f as je,g as tn,B as sn,U as an,F as on,h as k,i as U,a as _,k as rn,l as cn,m as ln,n as un,o as fn,j as ae,p as dn,q as mn}from"./index-9aaac598.js";import{p as W,u as He,a as We}from"./App2-f1c64941.js";function pn(n,e="pointer",t="auto"){m.useEffect(()=>{if(n)return document.body.style.cursor=e,()=>void(document.body.style.cursor=t)},[n])}function vn(n,e,t){return Math.max(e,Math.min(t,n))}function hn(n,e){return vn(n-Math.floor(n/e)*e,0,e)}function yn(n,e){var t=hn(e-n,Math.PI*2);return t>Math.PI&&(t-=Math.PI*2),t}var _n=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return o/Math.atan(1/t)*Math.atan(Math.sin(2*Math.PI*e*s)/t)},qe=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)};function u(n,e,t){var o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,i=arguments.length>6&&arguments[6]!==void 0?arguments[6]:qe,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,f="velocity_"+e;if(n.__damp===void 0&&(n.__damp={}),n.__damp[f]===void 0&&(n.__damp[f]=0),Math.abs(n[e]-t)<=c)return n[e]=t,!1;o=Math.max(1e-4,o);var E=2/o,x=i(E*s),h=n[e]-t,b=t,w=a*o;h=Math.min(Math.max(h,-w),w),t=n[e]-h;var z=(n.__damp[f]+E*h)*s;n.__damp[f]=(n.__damp[f]-E*z)*x;var P=t+(h+z)*x;return b-n[e]>0==P>b&&(P=b,n.__damp[f]=(P-b)/s),n[e]=P,!0}function G(n,e,t,o,s,a,i,c){return u(n,e,n[e]+yn(n[e],t),o,s,a,i,c)}var D=new Xe,oe,ie;function wn(n,e,t,o,s,a,i){return typeof e=="number"?D.setScalar(e):Array.isArray(e)?D.set(e[0],e[1]):D.copy(e),oe=u(n,"x",D.x,t,o,s,a,i),ie=u(n,"y",D.y,t,o,s,a,i),oe||ie}var S=new L,re,ce,le;function Y(n,e,t,o,s,a,i){return typeof e=="number"?S.setScalar(e):Array.isArray(e)?S.set(e[0],e[1],e[2]):S.copy(e),re=u(n,"x",S.x,t,o,s,a,i),ce=u(n,"y",S.y,t,o,s,a,i),le=u(n,"z",S.z,t,o,s,a,i),re||ce||le}var C=new J,ue,fe,de,me;function Mn(n,e,t,o,s,a,i){return typeof e=="number"?C.setScalar(e):Array.isArray(e)?C.set(e[0],e[1],e[2],e[3]):C.copy(e),ue=u(n,"x",C.x,t,o,s,a,i),fe=u(n,"y",C.y,t,o,s,a,i),de=u(n,"z",C.z,t,o,s,a,i),me=u(n,"w",C.w,t,o,s,a,i),ue||fe||de||me}var F=new Ye,pe,ve,he;function bn(n,e,t,o,s,a,i){return Array.isArray(e)?F.set(e[0],e[1],e[2],e[3]):F.copy(e),pe=G(n,"x",F.x,t,o,s,a,i),ve=G(n,"y",F.y,t,o,s,a,i),he=G(n,"z",F.z,t,o,s,a,i),pe||ve||he}var R=new Z,ye,_e,we;function gn(n,e,t,o,s,a,i){return e instanceof Z?R.copy(e):Array.isArray(e)?R.setRGB(e[0],e[1],e[2]):R.set(e),ye=u(n,"r",R.r,t,o,s,a,i),_e=u(n,"g",R.g,t,o,s,a,i),we=u(n,"b",R.b,t,o,s,a,i),ye||_e||we}var M=new ee,A=new J,Me=new J,Q=new J,be,ge,Ae,Ee;function Oe(n,e,t,o,s,a,i){var c=n;Array.isArray(e)?M.set(e[0],e[1],e[2],e[3]):M.copy(e);var f=n.dot(M)>0?1:-1;return M.x*=f,M.y*=f,M.z*=f,M.w*=f,be=u(n,"x",M.x,t,o,s,a,i),ge=u(n,"y",M.y,t,o,s,a,i),Ae=u(n,"z",M.z,t,o,s,a,i),Ee=u(n,"w",M.w,t,o,s,a,i),A.set(n.x,n.y,n.z,n.w).normalize(),Me.set(c.__damp.velocity_x,c.__damp.velocity_y,c.__damp.velocity_z,c.__damp.velocity_w),Q.copy(A).multiplyScalar(Me.dot(A)/A.dot(A)),c.__damp.velocity_x-=Q.x,c.__damp.velocity_y-=Q.y,c.__damp.velocity_z-=Q.z,c.__damp.velocity_w-=Q.w,n.set(A.x,A.y,A.z,A.w),be||ge||Ae||Ee}var j=new Te,Ie,xe,Pe;function An(n,e,t,o,s,a,i){return Array.isArray(e)?j.set(e[0],e[1],e[2]):j.copy(e),Ie=u(n,"radius",j.radius,t,o,s,a,i),xe=G(n,"phi",j.phi,t,o,s,a,i),Pe=G(n,"theta",j.theta,t,o,s,a,i),Ie||xe||Pe}var V=new en,Ce=new L,ze=new ee,Se=new L,Re,ke,Ge;function En(n,e,t,o,s,a,i){var c=n;return c.__damp===void 0&&(c.__damp={position:new L,rotation:new ee,scale:new L},n.decompose(c.__damp.position,c.__damp.rotation,c.__damp.scale)),Array.isArray(e)?V.set.apply(V,Ke(e)):V.copy(e),V.decompose(Ce,ze,Se),Re=Y(c.__damp.position,Ce,t,o,s,a,i),ke=Oe(c.__damp.rotation,ze,t,o,s,a,i),Ge=Y(c.__damp.scale,Se,t,o,s,a,i),n.compose(c.__damp.position,c.__damp.rotation,c.__damp.scale),Re||ke||Ge}var Le=Object.freeze({__proto__:null,rsqw:_n,exp:qe,damp:u,dampAngle:G,damp2:wn,damp3:Y,damp4:Mn,dampE:bn,dampC:gn,dampQ:Oe,dampS:An,dampM:En});const In=m.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:o,enableDamping:s=!0,keyEvents:a=!1,onChange:i,onStart:c,onEnd:f,...E},x)=>{const h=I(r=>r.invalidate),b=I(r=>r.camera),w=I(r=>r.gl),z=I(r=>r.events),P=I(r=>r.setEvents),O=I(r=>r.set),$=I(r=>r.get),B=I(r=>r.performance),v=e||b,g=o||z.connected||w.domElement,l=m.useMemo(()=>new nn(v),[v]);return je(()=>{l.enabled&&l.update()},-1),m.useEffect(()=>(a&&l.connect(a===!0?g:a),l.connect(g),()=>void l.dispose()),[a,g,t,l,h]),m.useEffect(()=>{const r=d=>{h(),t&&B.regress(),i&&i(d)},p=d=>{c&&c(d)},y=d=>{f&&f(d)};return l.addEventListener("change",r),l.addEventListener("start",p),l.addEventListener("end",y),()=>{l.removeEventListener("start",p),l.removeEventListener("end",y),l.removeEventListener("change",r)}},[i,c,f,l,h,P]),m.useEffect(()=>{if(n){const r=$().controls;return O({controls:l}),()=>O({controls:r})}},[n,l]),m.createElement("primitive",tn({ref:x,object:l,enableDamping:s},E))}),xn=Math.PI/180;function Be(n){return n*xn}const Pn=.5,Cn=.3,zn=.18,Sn=.05,Rn=.09,ne=1.28,kn=1.28,T=.003,te=30,N=ne/te,q=new sn(ne,kn,T,te,2);q.translate(ne/2,0,0);const De=q.attributes.position,Fe=new L,$e=[],Ve=[];for(let n=0;n<De.count;n++){Fe.fromBufferAttribute(De,n);const e=Fe.x,t=Math.max(0,Math.floor(e/N));let o=e%N/N;$e.push(t,t+1,0,0),Ve.push(1-o,o,0,0)}q.setAttribute("skinIndex",new an($e,4));q.setAttribute("skinWeight",new on(Ve,4));const H=new Z("white"),Qe=new Z("orange"),Gn=[new k({color:H}),new k({color:"#111"}),new k({color:H}),new k({color:H})];W.forEach(n=>{U.preload(`/textures/${n.front}.webp`),U.preload(`/textures/${n.back}.webp`),U.preload("/images/logo.webp")});const Ln=({number:n,front:e,back:t,page:o,opened:s,bookClosed:a,...i})=>{const[c,f,E]=U([`/textures/${e}.webp`,`/textures/${t}.webp`,...n===0||n===W.length-1?["/images/logo.webp"]:[]]);c.colorSpace=f.colorSpace=rn;const x=m.useRef(),h=m.useRef(0),b=m.useRef(s),w=m.useRef(),z=m.useMemo(()=>{const v=[];for(let p=0;p<=te;p++){let y=new cn;v.push(y),p===0?y.position.x=0:y.position.x=N,p>0&&v[p-1].add(y)}const g=new ln(v),l=[...Gn,new k({color:H,map:c,...n===0?{roughnessMap:E}:{roughness:.1},emissive:Qe,emissiveIntensity:0}),new k({color:H,map:f,...n===W.length-1?{roughnessMap:E}:{roughness:.1},emissive:Qe,emissiveIntensity:0})],r=new un(q,l);return r.castShadow=!0,r.receiveShadow=!0,r.frustumCulled=!1,r.add(g.bones[0]),r.bind(g),r},[]);je((v,g)=>{if(!w.current)return;const l=$?.22:0;w.current.material[4].emissiveIntensity=w.current.material[5].emissiveIntensity=fn.lerp(w.current.material[4].emissiveIntensity,l,.1),b.current!==s&&(h.current=+new Date,b.current=s);let r=Math.min(400,new Date-h.current)/400;r=Math.sin(r*Math.PI);let p=s?-Math.PI/2:Math.PI/2;a||(p+=Be(n*.8));const y=w.current.skeleton.bones;for(let d=0;d<y.length;d++){const se=d===0?x.current:y[d],Ue=d<8?Math.sin(d*.2+.25):0,Ne=d>=8?Math.cos(d*.3+.09):0,Ze=Math.sin(d*Math.PI*(1/y.length))*r;let K=zn*Ue*p-Sn*Ne*p+Rn*Ze*p,X=Be(Math.sign(p)*2);a&&(d===0?(K=p,X=0):(K=0,X=0)),Le.dampAngle(se.rotation,"y",K,Pn,g);const Je=d>8?Math.sin(d*Math.PI*(1/y.length)-.5)*r:0;Le.dampAngle(se.rotation,"x",X*Je,Cn,g)}});const[P,O]=He(We),[$,B]=m.useState(!1);return pn($),_("group",{...i,ref:x,onPointerEnter:v=>{v.stopPropagation(),B(!0)},onPointerLeave:v=>{v.stopPropagation(),B(!1)},onClick:v=>{v.stopPropagation(),O(s?n:n+1),B(!1)},children:_("primitive",{object:z,ref:w,"position-z":-n*T+o*T})})},Bn=({...n})=>{const[e]=He(We),[t,o]=m.useState(e);return m.useEffect(()=>{let s;const a=()=>{o(i=>{if(e===i)return i;if(s=setTimeout(()=>{a()},Math.abs(e-i)>2?50:150),e>i)return i+1;if(e<i)return i-1})};return a(),()=>{clearTimeout(s)}},[e]),_("group",{...n,"rotation-y":-Math.PI/2,children:[...W].map((s,a)=>_(Ln,{page:t,number:a,opened:t>a,bookClosed:t===0||t===W.length,...s},a))})},Qn=()=>{const[n,e]=m.useState(!1);return m.useEffect(()=>{const t=()=>{e(window.innerWidth<=768)};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]),ae(dn,{children:[_(mn,{"rotation-x":-Math.PI/6,floatIntensity:1,speed:.8,rotationIntensity:1,scale:n?1.5:.8,children:_(Bn,{})}),_(In,{enableZoom:!1,enablePan:!1})," ",_("color",{attach:"background",args:["#c7e6ff"]})," ",_("ambientLight",{intensity:.1})," ",_("directionalLight",{position:[2,10,5],intensity:.4,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-bias":-1e-4}),ae("mesh",{"position-y":-1.5,"rotation-x":-Math.PI/2,receiveShadow:!0,children:[_("planeGeometry",{args:[100,100]}),_("shadowMaterial",{transparent:!0,opacity:.2})," "]})]})};export{Qn as Experience2,Qn as default};
